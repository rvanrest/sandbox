# Variables
{
    "BemiddelingspecificatieID": "07eee19c-4be8-45b6-8da9-025f88621337",
    "Instelling": "66600011",
    "Today": "2024-05-21",
    "ToewijzingIngangsdatum": "2024-02-21",
    "ToewijzingEinddatum": "2024-04-17",
    "ToewijzingEinddatum31Mei": "2025-05-31",
    "ToewijzingEinddatum2Jaar": "2026-04-17"
}

# Query
query Bemiddelingspecificatie(
    $BemiddelingspecificatieID: UUID!
    $Instelling: String!
    $ToewijzingIngangsdatum: Date!
    $ToewijzingEinddatum: Date!
    $ToewijzingEinddatum2Jaar: Date!
    $ToewijzingEinddatum31Mei: Date!
) {
    bemiddelingspecificatie(
        where: {
            bemiddelingspecificatieID: { eq: $BemiddelingspecificatieID }
            instelling: { eq: $Instelling }
            toewijzingIngangsdatum: { eq: $ToewijzingIngangsdatum }
            toewijzingEinddatum: { eq: $ToewijzingEinddatum }
        }
    ) {
        bemiddelingspecificatieID
        leveringsvorm
        zzpCode
        toewijzingIngangsdatum
        toewijzingEinddatum
        instelling
        uitvoerendZorgkantoor
        vaststellingMoment
        percentage
        opname
        redenIntrekking
        etmalen
        instellingBestemming
        soortToewijzing
        bemiddeling {
            bemiddelingID
            wlzIndicatieID
            verantwoordelijkZorgkantoor
            verantwoordelijkheidIngangsdatum
            verantwoordelijkheidEinddatum
            client {
                bsn
                contactpersoon(
                    where: {
                        and: [
                            {
                                or: [{ einddatum: { eq: null } }, { einddatum: { gte: $ToewijzingIngangsdatum } }]
                            }
                            { ingangsdatum: { ngt: $ToewijzingEinddatum2Jaar } }
                        ]
                    }
                ) {
                    contactpersoonID
                    relatienummer
                    volgorde
                    soortRelatie
                    rol
                    relatie
                    geslachtsnaam
                    voorvoegselGeslachtsnaam
                    partnernaam
                    voorvoegselPartnernaam
                    voornamen
                    voorletters
                    roepnaam
                    naamgebruik
                    geslacht
                    geboortedatum
                    geboortedatumgebruik
                    ingangsdatum
                    einddatum
                    contactgegevens(
                        where: {
                            and: [
                                {
                                    or: [{ einddatum: { eq: null } }, { einddatum: { gte: $ToewijzingIngangsdatum } }]
                                }
                                { ingangsdatum: { ngt: $ToewijzingEinddatum2Jaar } }
                            ]
                        }
                    ) {
                        contactpersoonContactgegevensID
                        adresSoort
                        straatnaam
                        huisnummer
                        huisletter
                        huisnummerToevoeging
                        postcode
                        plaatsnaam
                        land
                        aanduidingWoonadres
                        emailadres
                        telefoonnummer01
                        landnummer01
                        telefoonnummer02
                        landnummer02
                        ingangsdatum
                        einddatum
                    }
                }
                leefeenheid
                huisarts
                communicatievorm
                taal
                contactgegevens(
                    where: {
                        and: [
                            {
                                or: [{ einddatum: { eq: null } }, { einddatum: { gte: $ToewijzingIngangsdatum } }]
                            }
                            { ingangsdatum: { ngt: $ToewijzingEinddatum2Jaar } }
                        ]
                    }
                ) {
                    clientContactgegevensID
                    adresSoort
                    straatnaam
                    huisnummer
                    huisletter
                    huisnummerToevoeging
                    postcode
                    plaatsnaam
                    land
                    aanduidingWoonadres
                    emailadres
                    telefoonnummer01
                    landnummer01
                    telefoonnummer02
                    landnummer02
                    ingangsdatum
                    einddatum
                }
                dossierhouder(
                    where: {
                        and: [
                            {
                                or: [{ einddatum: { eq: null } }, { einddatum: { gte: $ToewijzingIngangsdatum } }]
                            }
                            { ingangsdatum: { ngt: $ToewijzingEinddatum31Mei } }
                        ]
                    }
                ) {
                    dossierhouderID
                    instelling
                    ingangsdatum
                    einddatum
                }
                coordinatorZorgThuis(
                    where: {
                        and: [
                            {
                                or: [{ einddatum: { eq: null } }, { einddatum: { gte: $ToewijzingIngangsdatum } }]
                            }
                            { ingangsdatum: { ngt: $ToewijzingEinddatum31Mei } }
                        ]
                    }
                ) {
                    coordinatorZorgThuisID
                    instelling
                    ingangsdatum
                    einddatum
                }
                clientID
            }
            bemiddelingspecificatie(
                    where: {
                        and: [
                            {
                                or: [{ toewijzingEinddatum: { eq: null } }, { toewijzingEinddatum: { gte: $ToewijzingIngangsdatum } }]
                            }
                            { toewijzingIngangsdatum: { ngt: $ToewijzingEinddatum31Mei } }
                        ]
                    }
                ) {
                bemiddelingspecificatieID
                leveringsvorm
                zzpCode
                toewijzingIngangsdatum
                toewijzingEinddatum
                instelling
                uitvoerendZorgkantoor
                vaststellingMoment
                percentage
                opname
                redenIntrekking
                etmalen
                instellingBestemming
                soortToewijzing
            }
        }
    }
}
